<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Malla Interactiva - Licenciatura en Biotecnolog√≠a</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 20px;
      background-color: #f0f4f8;
    }
    #buscador {
      margin-bottom: 20px;
      padding: 8px 12px;
      font-size: 1em;
      width: 300px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    .materia {
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 8px 12px;
      margin: 5px;
      background-color: #ffffff;
      cursor: pointer;
      transition: background-color 0.3s, opacity 0.3s;
      opacity: 0.6;
      user-select: none;
      max-width: 280px;
      word-wrap: break-word;
    }
    .materia:hover {
      background-color: #dff0d8;
    }
    .materia.bloqueada {
      background-color: #555;
      opacity: 0.4;
      cursor: default;
    }
    .materia.cursando {
      background-color: #fff176; /* amarillo claro */
      opacity: 1;
    }
    .materia.aprobada {
      background-color: #4caf50; /* verde fuerte */
      opacity: 1;
    }
    .materia.desbloqueada {
      opacity: 1;
    }
    .correlativas {
      margin-top: 10px;
      padding: 10px;
      background-color: #eef;
      border-radius: 6px;
      display: none;
      user-select: text;
    }
    .anio {
      display: inline-block;
      vertical-align: top;
      margin-right: 20px;
      margin-bottom: 30px;
      padding: 10px;
      border: 2px solid #0074D9;
      background-color: #e3ecf5;
      border-radius: 8px;
      width: 300px;
    }
    .titulo-anio {
      font-size: 1.2em;
      margin-bottom: 10px;
      text-align: center;
      font-weight: bold;
    }
    .cuatrimestre {
      margin-bottom: 20px;
      padding: 5px;
    }
    .titulo-cuatrimestre {
      font-size: 1em;
      font-weight: bold;
      margin-bottom: 5px;
      text-align: center;
      background-color: #cce0f5;
      padding: 4px;
      border-radius: 4px;
    }
    /* Notificaci√≥n */
    #notificacion {
      position: fixed;
      top: 20px;
      right: 20px;
      background-color: #4caf50;
      color: white;
      padding: 15px 20px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.2);
      font-weight: bold;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.4s;
      z-index: 1000;
      max-width: 300px;
    }
    #notificacion.show {
      opacity: 1;
      pointer-events: auto;
    }
  </style>
</head>
<body>
  <h1>Malla Interactiva - Licenciatura en Biotecnolog√≠a</h1>
  <p><em>Doble clic sobre una materia para marcarla aprobada (verde). Clic simple para marcarla cursando (amarillo). Las correlativas se desbloquean autom√°ticamente.</em></p>
  <input type="text" id="buscador" placeholder="Buscar materia por c√≥digo o nombre..." />

  <div id="malla"></div>

  <div id="notificacion"></div>

  <script>
    const materiasPorCuatrimestre = {
      "1¬∫A√ëO": {
        "1¬∫ CUATRIMESTRE": ["N1", "CB02", "CB03", "CB04"],
        "2¬∫ CUATRIMESTRE": ["N2", "CB06", "CB07", "CB08"]
      },
      "2¬∫A√ëO": {
        "3¬∫ CUATRIMESTRE": ["CB12", "N10", "CB10"],
        "4¬∫ CUATRIMESTRE": ["N3", "CB11", "CB14", "N4"]
      },
      "3¬∫A√ëO": {
        "5¬∫ CUATRIMESTRE": ["CB16", "CB17", "N5", "CB19"],
        "6¬∫ CUATRIMESTRE": ["N11", "CB22", "N7"]
      },
      "4¬∫A√ëO": {
        "7¬∫ CUATRIMESTRE": ["CB23", "N12", "N6"],
        "8¬∫ CUATRIMESTRE": ["00157", "00162", "00155"]
      },
      "5¬∫A√ëO": {
        "9¬∫ CUATRIMESTRE": ["00159", "N8", "N13"],
        "10¬∫ CUATRIMESTRE": ["N9"]
      }
    };

    const materias = [
      { codigo: "N1", nombre: "AN√ÅLISIS 1" },
      { codigo: "CB02", nombre: "CIENCIA, TECNOLOG√çA Y SOCIEDAD" },
      { codigo: "CB03", nombre: "QU√çMICA GENERAL" },
      { codigo: "CB04", nombre: "BIOLOG√çA I" },
      { codigo: "N2", nombre: "INTRODUCCI√ìN A LA BIOTECNOLOG√çA", correlativas: ["CB04", "CB02"] },
      { codigo: "CB06", nombre: "√ÅLGEBRA Y GEOMETR√çA ANAL√çTICA" },
      { codigo: "CB07", nombre: "BIOLOG√çA II", correlativas: ["CB03", "CB04"] },
      { codigo: "CB08", nombre: "QU√çMICA INORG√ÅNICA", correlativas: ["N1", "CB03"] },
      { codigo: "CB12", nombre: "QU√çMICA ORG√ÅNICA", correlativas: ["CB08"] },
      { codigo: "N10", nombre: "AN√ÅLISIS II", correlativas: ["N1"] },
      { codigo: "CB10", nombre: "F√çSICA I", correlativas: ["N1"] },
      { codigo: "N3", nombre: "F√çSICA II", correlativas: ["N10", "CB10"] },
      { codigo: "CB11", nombre: "BIOLOG√çA III", correlativas: ["CB07"] },
      { codigo: "CB14", nombre: "ESTAD√çSTICA APLICADA", correlativas: ["N1", "CB06"] },
      { codigo: "N4", nombre: "QU√çMICA BIOL√ìGICA I", correlativas: ["CB07", "CB12"] },
      { codigo: "CB16", nombre: "FISICOQU√çMICA", correlativas: ["CB08", "N3"] },
      { codigo: "CB17", nombre: "GEN√âTICA GENERAL", correlativas: ["CB07", "CB14", "N4"] },
      { codigo: "N5", nombre: "QU√çMICA BIOL√ìGICA II", correlativas: ["N4"] },
      { codigo: "CB19", nombre: "BIOLOG√çA IV", correlativas: ["CB07", "CB12"] },
      { codigo: "N11", nombre: "MICROBIOLOG√çA", correlativas: ["N2", "N5", "CB17"] },
      { codigo: "CB22", nombre: "BIOLOG√çA CELULAR", correlativas: ["N5", "CB11"] },
      { codigo: "N7", nombre: "INTRODUCCI√ìN A LA BIOINFORM√ÅTICA", correlativas: ["CB14", "CB07"] },
      { codigo: "CB23", nombre: "INMUNOLOG√çA B√ÅSICA", correlativas: ["N5", "CB17"] },
      { codigo: "N12", nombre: "GEN√âTICA MOLECULAR", correlativas: ["CB17", "N11", "CB22"] },
      { codigo: "N6", nombre: "QU√çMICA ANAL√çTICA", correlativas: ["CB12", "CB14", "CB16"] },
      { codigo: "00157", nombre: "INMUNOLOG√çA MOLECULAR", correlativas: ["CB23", "N12"] },
      { codigo: "00162", nombre: "BIOTECNOLOG√çA ANIMAL", correlativas: ["N12"] },
      { codigo: "00155", nombre: "BIOQU√çMICA DE PROTE√çNAS", correlativas: ["N5", "N6", "CB16"] },
      { codigo: "00159", nombre: "BIOTECNOLOG√çA VEGETAL", correlativas: ["CB19", "N7", "N12"] },
      { codigo: "N8", nombre: "BIOPROCESOS", correlativas: ["N11", "N12", "CB16"] },
      { codigo: "N13", nombre: "M√âTODOS DE AN√ÅLISIS DE BIOMOL√âCULAS", correlativas: ["N6", "00157", "N7"] },
      { codigo: "N9", nombre: "PROYECTOS BIOTECNOL√ìGICOS", correlativas: ["N13", "N8", "00159", "00162", "N7"] },
    ];

    let aprobadas = new Set();
    let cursando = new Set();

    // Cargar desde localStorage
    function cargarProgreso() {
      const aprobadasLS = localStorage.getItem('biotec_aprobadas');
      const cursandoLS = localStorage.getItem('biotec_cursando');
      if (aprobadasLS) aprobadas = new Set(JSON.parse(aprobadasLS));
      if (cursandoLS) cursando = new Set(JSON.parse(cursandoLS));
    }
    // Guardar en localStorage
    function guardarProgreso() {
      localStorage.setItem('biotec_aprobadas', JSON.stringify([...aprobadas]));
      localStorage.setItem('biotec_cursando', JSON.stringify([...cursando]));
    }

    function estaDesbloqueada(materia) {
      if (!materia.correlativas) return true;
      return materia.correlativas.every(c => aprobadas.has(c));
    }

    // Mostrar notificaci√≥n no intrusiva
    function mostrarNotificacion(mensaje) {
      const noti = document.getElementById('notificacion');
      noti.textContent = mensaje;
      noti.classList.add('show');
      setTimeout(() => {
        noti.classList.remove('show');
      }, 3000);
    }

    function renderMalla(filtro = '') {
      const mallaDiv = document.getElementById("malla");
      mallaDiv.innerHTML = "";
      mallaDiv.style.display = "flex";
      mallaDiv.style.flexWrap = "wrap";

      const filtroMinuscula = filtro.toLowerCase();

      for (const [anio, cuatris] of Object.entries(materiasPorCuatrimestre)) {
        const anioDiv = document.createElement("div");
        anioDiv.className = "anio";

        const tituloAnio = document.createElement("div");
        tituloAnio.className = "titulo-anio";
        tituloAnio.textContent = anio;
        anioDiv.appendChild(tituloAnio);

        for (const [cuatri, codigos] of Object.entries(cuatris)) {
          const cuatriDiv = document.createElement("div");
          cuatriDiv.className = "cuatrimestre";

          const titulo = document.createElement("div");
          titulo.className = "titulo-cuatrimestre";
          titulo.textContent = cuatri;
          cuatriDiv.appendChild(titulo);

          codigos.forEach(codigo => {
            const materia = materias.find(m => m.codigo === codigo);
            if (!materia) return;

            // Filtro por b√∫squeda
            if (
              filtro &&
              !materia.codigo.toLowerCase().includes(filtroMinuscula) &&
              !materia.nombre.toLowerCase().includes(filtroMinuscula)
            ) {
              return;
            }

            const div = document.createElement("div");
            div.className = "materia";
            div.id = materia.codigo;
            div.textContent = `${materia.codigo} - ${materia.nombre}`;

            if (!estaDesbloqueada(materia)) {
              div.classList.add("bloqueada");
              div.style.cursor = "default";
            } else {
              div.classList.add("desbloqueada");
              if (aprobadas.has(materia.codigo)) {
                div.classList.add("aprobada");
              } else if (cursando.has(materia.codigo)) {
                div.classList.add("cursando");
              }
            }

            if (materia.correlativas) {
              const correlativasDiv = document.createElement("div");
              correlativasDiv.className = "correlativas";
              correlativasDiv.innerHTML = `<strong>Correlativas:</strong> ${materia.correlativas.join(", ")}`;
              div.appendChild(correlativasDiv);

              div.addEventListener("click", (e) => {
                if (estaDesbloqueada(materia)) {
                  correlativasDiv.style.display = correlativasDiv.style.display === "none" ? "block" : "none";
                }
              });
            }

            // Click simple para marcar cursando
            div.addEventListener("click", (e) => {
              if (!estaDesbloqueada(materia)) return;
              e.stopPropagation();
              if (aprobadas.has(materia.codigo)) return; // si ya aprobada, no cambia a cursando
              if (cursando.has(materia.codigo)) {
                cursando.delete(materia.codigo);
              } else {
                cursando.add(materia.codigo);
              }
              guardarProgreso();
              renderMalla(filtro);
            });

            // Doble click para marcar aprobada con felicitaci√≥n
            div.addEventListener("dblclick", (e) => {
              if (!estaDesbloqueada(materia)) return;
              e.stopPropagation();
              if (aprobadas.has(materia.codigo)) {
                aprobadas.delete(materia.codigo);
              } else {
                aprobadas.add(materia.codigo);
                cursando.delete(materia.codigo);
                mostrarNotificacion(`¬°Felicitaciones! Has aprobado ${materia.nombre} üéâ`);
              }
              guardarProgreso();
              renderMalla(filtro);
            });

            cuatriDiv.appendChild(div);
          });

          anioDiv.appendChild(cuatriDiv);
        }

        mallaDiv.appendChild(anioDiv);
      }
    }

    // Event listener para el buscador
    document.getElementById('buscador').addEventListener('input', (e) => {
      renderMalla(e.target.value);
    });

    cargarProgreso();
    renderMalla();
  </script>
</body>
</html>


